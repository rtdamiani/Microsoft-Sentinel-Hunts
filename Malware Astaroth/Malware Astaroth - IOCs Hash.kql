let IOCs = dynamic(["01782747C12Bf06A52704A144DB59FEC41B3CB36" ,"NF-e513468.zip" ,"1F83403398964D4E8B6C70B171C51CD278909172" ,"CE8BDB56CCAC55C6881701EBD39DA316EE7ED18D" ,"lrdsnhrxxfery64.~" ,"926137A50f473BBD257CD19E207C1C9114F6B215" ,"lrdsnhrxxfery98.~" ,"5579E03EB1DA076EF939196CB14F8B769F30A302" ,"lrdsnhrxxferyb.jpg" ,"B2734835888756929EE3FF4DCDE85080CB299D2A" ,"lrdsnhrxxferyc.jpg" ,"206352E13D601239E2D043D971EA6657C091071A" ,"lrdsnhrxxferydwwn.gif" ,"EAE82A63A980998F8D388BCCE7D967F28309F593" ,"lrdsnhrxxferydwwn.gif" ,"9CD5A399C9320CBFB87C9D1CAD3BC366FB12E54F" ,"lrdsnhrxxferydx.gif" ,"206352E13D601239E2D043D971EA6657C091071A" ,"lrdsnhrxxferye.jpg" ,"4CDE9A53A9A49D606BC89E74D47398A69E767056" ,"lrdsnhrxxferyg.gif" ,"F99319B1B321AE9F2D1F0361BC756A43D25444CE" ,"lrdsnhrxxferygx.gif" ,"B85C106B68ED410107f97A2CC38b7EC05353F1FA" ,"lrdsnhrxxferyxa.~" ,"77809236FDF621ABE37B32BF073B0B893E9CE67A" ,"lrdsnhrxxferyxb.~" ,"B85C106B68ED410107f97A2CC38b7EC05353F1fA" ,"lrdsnhrxxferyxa.~" ,"C2F3350AC58DE900768032554C009C4A78C47CCC" ,"r1.log"]);
DeviceEvents | union DeviceProcessEvents | union DeviceFileEvents | union DeviceNetworkEvents | union SecurityEvent | union CommonSecurityLog | union EmailEvents | union EmailAttachmentInfo | union EmailUrlInfo | union UrlClickEvents | union SigninLogs
| where TimeGenerated > ago(30d)
| where SHA256 has_any (IOCs) or SHA1 has_any (IOCs) or MD5 has_any (IOCs) or InitiatingProcessSHA1 has_any (IOCs) or InitiatingProcessSHA256 has_any (IOCs) or InitiatingProcessMD5 has_any (IOCs) or FolderPath has_any (IOCs) or ProcessName has_any (IOCs) or NewProcessName has_any (IOCs) or ParentProcessName has_any (IOCs) or InitiatingProcessFolderPath has_any (IOCs) or InitiatingProcessParentFileName has_any (IOCs) or InitiatingProcessFileName has_any (IOCs) or FileName has_any (IOCs) 
| project-reorder Type, TimeGenerated, ActionType, DeviceAction, InitiatingProcessAccountName, AccountName, DeviceName, Computer, InitiatingProcessParentFileName, InitiatingProcessFileName, FileName, InitiatingProcessFolderPath, FolderPath, SourceIP, DestinationIP, LocalIP, RemoteIP, SenderIPv4, RequestURL, Url, RemoteUrl, SHA256, SHA1, InitiatingProcessSHA1, InitiatingProcessSHA256