DeviceProcessEvents
| where TimeGenerated > ago(30d)
| where InitiatingProcessFileName endswith @"\msiexec.exe" or InitiatingProcessFileName endswith @"\msiexec.exe" or FileName endswith @"\msiexec.exe" or FileName endswith @"\msiexec.exe"
| where ProcessCommandLine has @"C:\Public" or ProcessCommandLine has @"\AppData\Local\Temp" or ProcessCommandLine has @"\Downloads\"
| order by TimeGenerated desc