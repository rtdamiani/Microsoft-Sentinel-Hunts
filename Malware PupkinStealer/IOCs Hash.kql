let IOCs = dynamic(["fc99a7ef8d7a2028ce73bf42d3a95bce","84dd5bc96170c98ad1d1ec90e8f09ec99e6dc9db","9309003c245f94ba4ee52098dadbaa0d0a4d83b423d76c1bfc082a1c29e0b95f","8013735771:AAE_UrTgQsAmiAsXeDN6mehD_fo3vEg-kCM","https://api.telegram.org/bot","/sendDocument?chat_id=7613862165&caption", @"\Grabbers\Browser\passwords.txt" ,@"\Grabbers\TelegramSession\" ,@"\Grabbers\Discord\Tokens.txt" ,@"\Grabbers\Screenshot\Screen.jpg" ,@"\DesktopFiles\" ,"ardent.zip"]);
DeviceEvents | union DeviceProcessEvents | union DeviceFileEvents | union DeviceNetworkEvents | union SecurityEvent | union CommonSecurityLog | union EmailEvents | union EmailAttachmentInfo | union EmailUrlInfo | union UrlClickEvents | union SigninLogs
| where TimeGenerated > ago(30d)
| where SourceIP has_any (IOCs) or DestinationIP has_any (IOCs) or LocalIP has_any (IOCs) or RemoteIP has_any (IOCs) or SenderIPv4 has_any (IOCs) or RequestURL has_any (IOCs) or Url has_any (IOCs) or RemoteUrl has_any (IOCs) or SHA256 has_any (IOCs) or SHA1 has_all (IOCs) or InitiatingProcessSHA1 has_any (IOCs) or InitiatingProcessSHA256 has_any (IOCs) or FolderPath has_any (IOCs) or InitiatingProcessFolderPath has_any (IOCs)
| project-reorder Type, TimeGenerated, ActionType, DeviceAction, InitiatingProcessAccountName, AccountName, DeviceName, Computer, InitiatingProcessParentFileName, InitiatingProcessFileName, FileName, InitiatingProcessFolderPath, FolderPath, SourceIP ,DestinationIP ,LocalIP ,RemoteIP ,SenderIPv4 ,RequestURL ,Url ,RemoteUrl ,SHA256 ,SHA1, InitiatingProcessSHA1, InitiatingProcessSHA256
